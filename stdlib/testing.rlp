(__load "stdlib/defines.rlp")

(macro (std/testing/assert pred msg)
    `(if ,pred
        none
        (let ((obj-msg ,(to-str pred)))
          (panic! (+ obj-msg "is False:" ,msg)))))

(macro (std/testing/assert-equal? a b msg)
    `(if (equal? ,a ,b)
        none
        (let ((obj-repr ,(+ (to-str a) "!=" (to-str b)))
              (eq-msg (+ (to-str ,a) "!=" (to-str ,b))))
            (let ((final-msg (+ ,msg ": " obj-repr " " eq-msg)))
                (panic! final-msg)))))

(macro (std/testing/assert-eq? a b msg)
    `(if (eq? ,a ,b)
        none
        (let ((obj-repr ,(+ (to-str a) "!=" (to-str b)))
              (eq-msg (+ (to-str ,a) "!=" (to-str ,b))))
            (let ((final-msg (+ ,msg ":" obj-repr " " eq-msg)))
                (panic! final-msg)))))